# Marketplace API üõçÔ∏è

## –ü–æ—Ö–æ–∂–µ –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–¢–æ–≤–∞—Ä—ã

### –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã üîß

* **POST** `imports/` –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ 
* **POST** `delete/{id}` —É–¥–∞–ª—è–µ–º —Ç–æ–≤–∞—Ä
* **GET** `nodes/{id}` –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ —Ç–æ–≤–∞—Ä–µ

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è üõ†Ô∏è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∞–Ω–Ω—ã–º –ø—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ `/imports` üî∫

* uuid —Ç–æ–≤–∞—Ä–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å—Ä–µ–¥–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
* —Ä–æ–¥–∏—Ç–µ–ª–µ–º —Ç–æ–≤–∞—Ä–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
* –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–ª–µ–º parentId
* —Ç–æ–≤–∞—Ä –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –º–æ–≥—É—Ç –Ω–µ –∏–º–µ—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—è (–ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ parentId –Ω–∞ null, —ç–ª–µ–º–µ–Ω—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ —Ä–æ–¥–∏—Ç–µ–ª—è)
* –Ω–∞–∑–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å null
* —É –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–ª–µ price –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å null
* —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å null –∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ –ª–∏–±–æ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é.
* –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –≤—Å–µ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
* –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ date –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤—Ä–µ–º–µ–Ω–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
* –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º id
* –¥–∞—Ç–∞ –¥–æ–ª–∂–Ω–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ ISO 8601 (—Ç–∞–∫–æ–π –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è OpenAPI). –ï—Å–ª–∏ –¥–∞—Ç–∞ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç –¥–∞–Ω–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–≤–µ—á–∞—Ç—å 400.

–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –≤–æ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø–æ–ª–µ updateDate –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è –∫—Ä–∞—Ç–Ω–æ —Å–µ–∫—É–Ω–¥–∞–º.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–¥–∞–ª–µ–Ω–∏—é `/delete/{id}` ‚ùå

* –ï—Å–ª–∏ –Ω–µ—Ç —É–∑–ª–∞ —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º `id` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404
* –ï—Å–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (*uuid*), –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 400
* –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –¥–æ—á–µ—Ä–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É `/nodes/{id}` üëÄ

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ (—É–¥–∞–ª–µ–Ω–∏–∏) —É–∑–ª–∞, —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π **–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–∞-—Ä–æ–¥–∏—Ç–µ–ª–∏** –æ–±–Ω–æ–≤–ª—è—é—Ç —Å–≤–æ–∏ —Ü–µ–Ω—ã. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ü–µ–ª–æ–µ —Å—Ä–µ–¥–Ω–µ–µ —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É –∏ –æ—Ç–≤–µ—Ç—É –∫–∞–∫ –≤ –ø—É–Ω–∫—Ç–µ –≤—ã—à–µ

### –ú–æ–¥–µ–ª—å —Ç–æ–≤–∞—Ä–∞ ShopUnit üõí
* _id*_	**string($uuid)** <br>
  nullable: false <br>
  example: 3fa85f64-5717-4562-b3fc-2c963f66a333

* _name*_	**string** <br>
nullable: false <br>
–ò–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

* _date*_	**string($date-time)** <br>
nullable: false <br>
example: 2022-05-28T21:12:01.000Z <br>
–í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞.

* _parentId_	**string($uuid)** <br>
nullable: true <br>
example: 3fa85f64-5717-4562-b3fc-2c963f66a333 <br>
UUID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

* *type**	**ShopUnitType** <br>
–¢–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞ - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏–ª–∏ —Ç–æ–≤–∞—Ä <br>
Enum ["OFFER", "CATEGORY"]

* *children* **List[ShopUnit]**

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ üéØ

1. `poetry install --no-dev` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
2. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç –Ω—É–∂–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã DB_URL, REDIS_CACHE_URL, HOST, PORT. <br>
    –§–ª–∞–≥ `debug` –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –≤ —Ñ–∞–π–ª–µ `app/config.py`
3. `poetry run runserver` - –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ üìà

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î üíΩ

* –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Å–µ–π—á–∞—Å ~O(n^2). Relation –æ—Ç SQLAlchemy –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ Gino
* ~–ü–æ–¥–∫–ª—é—á–∏—Ç—å [ReJSON](https://redis.io/docs/stack/json/) –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–¥~

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ üîß

* **GET** `sales` –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤, —Ü–µ–Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–±–Ω–æ–≤–∏–ª–∞—Å—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏
* **GET** `node/{id}/statistic` –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ —Ç–æ–≤–∞—Ä–µ –∑–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ [–æ—Ç –∏ –¥–æ)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è üõ†Ô∏è

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ `/sales` üè∑Ô∏è

* –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –∑–Ω–∞—á–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ
* –î–∞—Ç–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ query-–ø–∞—Ä–∞–º–µ—Ç—Ä —Å–æ–≥–ª–∞—Å–Ω–æ ISO 8601, –µ—Å–ª–∏ –Ω–µ –≤–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç - –≤–æ–∑–≤—Ä–∞—Ç 400 –æ—à–∏–±–∫–∏

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ `node/{id}/statistic` üìù

* –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞
* –î–∞—Ç–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –¥–≤—É–º—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ `dateStart` –∏ `dateEnd` –∫–∞–∫ query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ ISO 8601,
–∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—Ç 400 –æ—à–∏–±–∫–∏, —Ç–∞–∫ –∂–µ –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º `id`
* –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä–∞ –Ω–µ—Ç –ø–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º—É `id`, —Ç–æ –≤–æ–∑–≤—Ä–∞—Ç 404 –æ—à–∏–±–∫–∏

---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ üíª

[FastAPI](https://fastapi.tiangolo.com/): –ö–∞–∫ –∫–∞—Ä–∫–∞—Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

[Uvicorn](https://www.uvicorn.org/): –°–µ—Ä–≤–µ—Ä –¥–ª—è ASGI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

[Pydantic](https://pydantic-docs.helpmanual.io/): –í–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

[SQLAlchemy](https://www.sqlalchemy.org/): ORM

[Gino](https://python-gino.org/): –ù–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–¥ SQLAlchemy –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

[Alembic](https://alembic.sqlalchemy.org/en/latest/): –î–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ Python -> PostgreSQL

[Poetry](https://python-poetry.org/): –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ —Å –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

[ReJSON](https://redis.io/docs/stack/json/): –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
